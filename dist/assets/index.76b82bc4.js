var P=Object.defineProperty;var S=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var k=(e,a,l)=>a in e?P(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l,A=(e,a)=>{for(var l in a||(a={}))z.call(a,l)&&k(e,l,a[l]);if(S)for(var l of S(a))O.call(a,l)&&k(e,l,a[l]);return e};import{a as J,u as I,T as M,g as H,d as K}from"./table.4dfabcdb.js";import{d as N,L as Q,k as y,_ as L,r as u,o as c,v as _,w as r,b as o,c as E,q as j,F as q,f as D,t as v,j as C,B as R,a as w,C as W,D as X,E as Y}from"./index.d6404b28.js";import{P as Z}from"./Plus.d5285924.js";import{S as x}from"./Search.b5a77ed6.js";import{D as ee}from"./Delete.bcef708f.js";const U=[{value:1,label:"\u8FD0\u52A8"},{value:2,label:"\u5065\u8EAB"},{value:3,label:"\u8DD1\u9177"},{value:4,label:"\u8857\u821E"}],G=[{value:1,label:"\u4ECA\u5929"},{value:2,label:"\u660E\u5929"},{value:3,label:"\u540E\u5929"}],ae=N({components:{Layer:Q},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const l=y(null),f=y(null);let m=y({name:""});const h={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],number:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u5B57",trigger:"blur"}],choose:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}],radio:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}]};s();function s(){e.layer.row&&(m.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:m,rules:h,layerDom:f,ruleForm:l,selectData:U,radioData:G}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){J(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){I(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function le(e,a,l,f,m,h){const s=u("el-input"),i=u("el-form-item"),F=u("el-option"),p=u("el-select"),$=u("el-radio"),d=u("el-radio-group"),b=u("el-form"),n=u("Layer",!0);return c(),_(n,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:r(()=>[o(b,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:r(()=>[o(i,{label:"\u540D\u79F0\uFF1A",prop:"name"},{default:r(()=>[o(s,{modelValue:e.form.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.form.name=t),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(i,{label:"\u6570\u5B57\uFF1A",prop:"number"},{default:r(()=>[o(s,{modelValue:e.form.number,"onUpdate:modelValue":a[1]||(a[1]=t=>e.form.number=t),oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"\u53EA\u80FD\u8F93\u5165\u6B63\u6574\u6570"},null,8,["modelValue"])]),_:1}),o(i,{label:"\u9009\u62E9\u5668\uFF1A",prop:"select"},{default:r(()=>[o(p,{modelValue:e.form.choose,"onUpdate:modelValue":a[2]||(a[2]=t=>e.form.choose=t),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:r(()=>[(c(!0),E(q,null,j(e.selectData,t=>(c(),_(F,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"\u5355\u9009\u6846\uFF1A",prop:"radio"},{default:r(()=>[o(d,{modelValue:e.form.radio,"onUpdate:modelValue":a[3]||(a[3]=t=>e.form.radio=t)},{default:r(()=>[(c(!0),E(q,null,j(e.radioData,t=>(c(),_($,{key:t.value,label:t.value},{default:r(()=>[D(v(t.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var oe=L(ae,[["render",le]]);const te=N({name:"crudTable",components:{Table:M,Layer:oe},setup(){const e=C({input:""}),a=C({show:!1,title:"\u65B0\u589E",showButton:!0}),l=C({index:1,size:20,total:0}),f=y(!0),m=y([]),h=y([]),s=d=>{h.value=d},i=d=>{f.value=!0,d&&(l.index=1);let b=A({page:l.index,pageSize:l.size},e);H(b).then(n=>{let t=n.data.list;Array.isArray(t)&&t.forEach(g=>{const T=U.find(B=>B.value===g.choose);T?g.chooseName=T.label:g.chooseName=g.choose;const V=G.find(B=>B.value===g.radio);V?g.radioName=V.label:g.radio}),m.value=n.data.list,l.total=Number(n.data.pager.total)}).catch(n=>{m.value=[],l.index=1,l.total=0}).finally(()=>{f.value=!1})},F=d=>{let b={ids:d.map(n=>n.id).join(",")};K(b).then(n=>{Y({type:"success",message:"\u5220\u9664\u6210\u529F"}),i(m.value.length===1)})},p=()=>{a.title="\u65B0\u589E\u6570\u636E",a.show=!0,delete a.row},$=d=>{a.title="\u7F16\u8F91\u6570\u636E",a.row=d,a.show=!0};return i(!0),{Plus:Z,Search:x,Delete:ee,query:e,tableData:m,chooseData:h,loading:f,page:l,layer:a,handleSelectionChange:s,handleAdd:p,handleEdit:$,handleDel:F,getTableData:i}}}),ne={class:"layout-container"},re={class:"layout-container-form flex space-between"},ue={class:"layout-container-form-handle"},se={class:"layout-container-form-search"},ie={class:"layout-container-table"};function de(e,a,l,f,m,h){const s=u("el-button"),i=u("el-popconfirm"),F=u("el-input"),p=u("el-table-column"),$=u("Table"),d=u("Layer"),b=R("loading");return c(),E("div",ne,[w("div",re,[w("div",ue,[o(s,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:r(()=>[D(v(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),o(i,{title:e.$t("message.common.delTip"),onConfirm:a[0]||(a[0]=n=>e.handleDel(e.chooseData))},{reference:r(()=>[o(s,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:r(()=>[D(v(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])]),w("div",se,[o(F,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=n=>e.query.input=n),placeholder:e.$t("message.common.searchTip"),onChange:a[2]||(a[2]=n=>e.getTableData(!0))},null,8,["modelValue","placeholder"]),o(s,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[3]||(a[3]=n=>e.getTableData(!0))},{default:r(()=>[D(v(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),w("div",ie,[W((c(),_($,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=n=>e.page=n),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:r(()=>[o(p,{prop:"name",label:"\u540D\u79F0",align:"center"}),o(p,{prop:"number",label:"\u6570\u5B57",align:"center"}),o(p,{prop:"chooseName",label:"\u9009\u62E9\u5668",align:"center"}),o(p,{prop:"radioName",label:"\u5355\u9009\u6846",align:"center"}),o(p,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:r(n=>[o(s,{onClick:t=>e.handleEdit(n.row)},{default:r(()=>[D(v(e.$t("message.common.update")),1)]),_:2},1032,["onClick"]),o(i,{title:e.$t("message.common.delTip"),onConfirm:t=>e.handleDel([n.row])},{reference:r(()=>[o(s,{type:"danger"},{default:r(()=>[D(v(e.$t("message.common.del")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[b,e.loading]]),e.layer.show?(c(),_(d,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):X("",!0)])])}var he=L(te,[["render",de]]);export{he as default};
