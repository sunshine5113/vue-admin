import{_ as e,G as t,e as n,a2 as o,aY as r,b4 as i,m as a,a1 as s,dm as u,aP as l,o as c,X as d,x as p,ag as f,cK as h,cJ as g,dn as m,a3 as v,a$ as y,M as x,cW as b,aB as _,aC as C,cg as w,Y as M,c5 as T,ae as A,bR as k,a_ as S,ch as O,K as I,dp as R,b5 as L,ak as B,dq as D,dr as E,a as z,aX as P,A as V,w as N,ds as Z,Q as H,dt as j,du as X,u as Y}from"./install.f743767a.js";import{D as G,a as W,i as U}from"./installCommon.e6fb8a9d.js";import{l as q,m as $}from"./install.7215798d.js";import{t as F,r as K,s as J}from"./sliderMove.9fa02ce2.js";import{o as Q}from"./cursorHelper.990d559a.js";var ee=Math.min,te=Math.max,ne=Math.pow,oe={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},re={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},ie={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},ae=0,se=function(u){function l(e){var r=u.call(this)||this;return r._track=[],r._covers=[],r._handlers={},r._zr=e,r.group=new t,r._uid="brushController_"+ae++,n(De,(function(e,t){this._handlers[t]=o(e,this)}),r),r}return e(l,u),l.prototype.enableBrush=function(e){return this._brushType&&this._doDisableBrush(),e.brushType&&this._doEnableBrush(e),this},l.prototype._doEnableBrush=function(e){var t=this._zr;this._enableGlobalPan||F(t,"globalPan",this._uid),n(this._handlers,(function(e,n){t.on(n,e)})),this._brushType=e.brushType,this._brushOption=r(i(ie),e,!0)},l.prototype._doDisableBrush=function(){var e=this._zr;K(e,"globalPan",this._uid),n(this._handlers,(function(t,n){e.off(n,t)})),this._brushType=this._brushOption=null},l.prototype.setPanels=function(e){if(e&&e.length){var t=this._panels={};n(e,(function(e){t[e.panelId]=i(e)}))}else this._panels=null;return this},l.prototype.mount=function(e){e=e||{},this._enableGlobalPan=e.enableGlobalPan;var t=this.group;return this._zr.add(t),t.attr({x:e.x||0,y:e.y||0,rotation:e.rotation||0,scaleX:e.scaleX||1,scaleY:e.scaleY||1}),this._transform=t.getLocalTransform(),this},l.prototype.updateCovers=function(e){e=a(e,(function(e){return r(i(ie),e,!0)}));var t=this._covers,n=this._covers=[],o=this,u=this._creatingCover;return new s(t,e,(function(e,t){return l(e.__brushOption,t)}),l).add(c).update(c).remove((function(e){t[e]!==u&&o.group.remove(t[e])})).execute(),this;function l(e,t){return(null!=e.id?e.id:"\0-brush-index-"+t)+"-"+e.brushType}function c(r,i){var a=e[r];if(null!=i&&t[i]===u)n[r]=t[i];else{var s=n[r]=null!=i?(t[i].__brushOption=a,t[i]):le(o,ue(o,a));pe(o,s)}}},l.prototype.unmount=function(){return this.enableBrush(!1),me(this),this._zr.remove(this.group),this},l.prototype.dispose=function(){this.unmount(),this.off()},l}(u);function ue(e,t){var n=ze[t.brushType].createCover(e,t);return n.__brushOption=t,de(n,t),e.group.add(n),n}function le(e,t){var n=fe(t);return n.endCreating&&(n.endCreating(e,t),de(t,t.__brushOption)),t}function ce(e,t){var n=t.__brushOption;fe(t).updateCoverShape(e,t,n.range,n)}function de(e,t){var n=t.z;null==n&&(n=1e4),e.traverse((function(e){e.z=n,e.z2=n}))}function pe(e,t){fe(t).updateCommon(e,t),ce(e,t)}function fe(e){return ze[e.__brushOption.brushType]}function he(e,t,o){var r,i=e._panels;if(!i)return true;var a=e._transform;return n(i,(function(e){e.isTargetByCursor(t,o,a)&&(r=e)})),r}function ge(e,t){var n=e._panels;if(!n)return true;var o=t.__brushOption.panelId;return null==o||n[o]}function me(e){var t=e._covers,o=t.length;return n(t,(function(t){e.group.remove(t)}),e),t.length=0,!!o}function ve(e,t){var n=a(e._covers,(function(e){var t=e.__brushOption,n=i(t.range);return{brushType:t.brushType,panelId:t.panelId,range:n}}));e.trigger("brush",{areas:n,isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function ye(e){var t=e.length-1;return t<0&&(t=0),[e[0],e[t]]}function xe(e,o,r,i){var a=new t;return a.add(new f({name:"main",style:we(r),silent:!0,draggable:!0,cursor:"move",drift:p(Ae,e,o,a,["n","s","w","e"]),ondragend:p(ve,o,{isEnd:!0})})),n(i,(function(t){a.add(new f({name:t.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:p(Ae,e,o,a,t),ondragend:p(ve,o,{isEnd:!0})}))})),a}function be(e,t,n,o){var r=o.brushStyle.lineWidth||0,i=te(r,6),a=n[0][0],s=n[1][0],u=a-r/2,l=s-r/2,c=n[0][1],d=n[1][1],p=c-i+r/2,f=d-i+r/2,h=c-a,g=d-s,m=h+r,v=g+r;Ce(e,t,"main",a,s,h,g),o.transformable&&(Ce(e,t,"w",u,l,i,v),Ce(e,t,"e",p,l,i,v),Ce(e,t,"n",u,l,m,i),Ce(e,t,"s",u,f,m,i),Ce(e,t,"nw",u,l,i,i),Ce(e,t,"ne",p,l,i,i),Ce(e,t,"sw",u,f,i,i),Ce(e,t,"se",p,f,i,i))}function _e(e,t){var o=t.__brushOption,r=o.transformable,i=t.childAt(0);i.useStyle(we(o)),i.attr({silent:!r,cursor:r?"move":"default"}),n([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],(function(n){var o=t.childOfName(n.join("")),i=1===n.length?Te(e,n[0]):function(e,t){var n=[Te(e,t[0]),Te(e,t[1])];return("e"===n[0]||"w"===n[0])&&n.reverse(),n.join("")}(e,n);o&&o.attr({silent:!r,invisible:!r,cursor:r?re[i]+"-resize":null})}))}function Ce(e,t,n,o,r,i,a){var s,u,l,c,d,p=t.childOfName(n);p&&p.setShape((s=Oe(e,t,[[o,r],[o+i,r+a]]),u=ee(s[0][0],s[1][0]),l=ee(s[0][1],s[1][1]),c=te(s[0][0],s[1][0]),d=te(s[0][1],s[1][1]),{x:u,y:l,width:c-u,height:d-l}))}function we(e){return c({strokeNoScale:!0},e.brushStyle)}function Me(e,t,n,o){var r=[ee(e,n),ee(t,o)],i=[te(e,n),te(t,o)];return[[r[0],i[0]],[r[1],i[1]]]}function Te(e,t){return{left:"w",right:"e",top:"n",bottom:"s"}[h({w:"left",e:"right",n:"top",s:"bottom"}[t],function(e){return g(e.group)}(e))]}function Ae(e,t,o,r,i,a){var s=o.__brushOption,u=e.toRectRange(s.range),l=Se(t,i,a);n(r,(function(e){var t=oe[e];u[t[0]][t[1]]+=l[t[0]]})),s.range=e.fromRectRange(Me(u[0][0],u[1][0],u[0][1],u[1][1])),pe(t,o),ve(t,{isEnd:!1})}function ke(e,t,o,r){var i=t.__brushOption.range,a=Se(e,o,r);n(i,(function(e){e[0]+=a[0],e[1]+=a[1]})),pe(e,t),ve(e,{isEnd:!1})}function Se(e,t,n){var o=e.group,r=o.transformCoordToLocal(t,n),i=o.transformCoordToLocal(0,0);return[r[0]-i[0],r[1]-i[1]]}function Oe(e,t,n){var o=ge(e,t);return o&&true!==o?o.clipPath(n,e._transform):i(n)}function Ie(e){var t=e.event;t.preventDefault&&t.preventDefault()}function Re(e,t,n){return e.childOfName("main").contain(t,n)}function Le(e,t,n,o){var r,a=e._creatingCover,s=e._creatingPanel,u=e._brushOption;if(e._track.push(n.slice()),function(e){var t=e._track;if(!t.length)return!1;var n=t[t.length-1],o=t[0],r=n[0]-o[0],i=n[1]-o[1];return ne(r*r+i*i,.5)>6}(e)||a){if(s&&!a){"single"===u.brushMode&&me(e);var l=i(u);l.brushType=Be(l.brushType,s),l.panelId=true===s?null:s.panelId,a=e._creatingCover=ue(e,l),e._covers.push(a)}if(a){var c=ze[Be(e._brushType,s)];a.__brushOption.range=c.getCreatingRange(Oe(e,a,e._track)),o&&(le(e,a),c.updateCommon(e,a)),ce(e,a),r={isEnd:o}}}else o&&"single"===u.brushMode&&u.removeOnClick&&he(e,t,n)&&me(e)&&(r={isEnd:o,removeOnClick:!0});return r}function Be(e,t){return"auto"===e?t.defaultBrushType:e}var De={mousedown:function(e){if(this._dragging)Ee(this,e);else if(!e.target||!e.target.draggable){Ie(e);var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null,(this._creatingPanel=he(this,e,t))&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(e){var t=e.offsetX,n=e.offsetY,o=this.group.transformCoordToLocal(t,n);if(function(e,t,n){if(e._brushType&&!function(e,t,n){var o=e._zr;return t<0||t>o.getWidth()||n<0||n>o.getHeight()}(e,t.offsetX,t.offsetY)){var o=e._zr,r=e._covers,i=he(e,t,n);if(!e._dragging)for(var a=0;a<r.length;a++){var s=r[a].__brushOption;if(i&&(!0===i||s.panelId===i.panelId)&&ze[s.brushType].contain(r[a],n[0],n[1]))return}i&&o.setCursorStyle("crosshair")}}(this,e,o),this._dragging){Ie(e);var r=Le(this,e,o,!1);r&&ve(this,r)}},mouseup:function(e){Ee(this,e)}};function Ee(e,t){if(e._dragging){Ie(t);var n=t.offsetX,o=t.offsetY,r=e.group.transformCoordToLocal(n,o),i=Le(e,t,r,!0);e._dragging=!1,e._track=[],e._creatingCover=null,i&&ve(e,i)}}var ze={lineX:Pe(0),lineY:Pe(1),rect:{createCover:function(e,t){function n(e){return e}return xe({toRectRange:n,fromRectRange:n},e,t,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(e){var t=ye(e);return Me(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(e,t,n,o){be(e,t,n,o)},updateCommon:_e,contain:Re},polygon:{createCover:function(e,n){var o=new t;return o.add(new l({name:"main",style:we(n),silent:!0})),o},getCreatingRange:function(e){return e},endCreating:function(e,t){t.remove(t.childAt(0)),t.add(new d({name:"main",draggable:!0,drift:p(ke,e,t),ondragend:p(ve,e,{isEnd:!0})}))},updateCoverShape:function(e,t,n,o){t.childAt(0).setShape({points:Oe(e,t,n)})},updateCommon:_e,contain:Re}};function Pe(e){return{createCover:function(t,n){return xe({toRectRange:function(t){var n=[t,[0,100]];return e&&n.reverse(),n},fromRectRange:function(t){return t[e]}},t,n,[[["w"],["e"]],[["n"],["s"]]][e])},getCreatingRange:function(t){var n=ye(t);return[ee(n[0][e],n[1][e]),te(n[0][e],n[1][e])]},updateCoverShape:function(t,n,o,r){var i,a=ge(t,n);if(true!==a&&a.getLinearBrushOtherExtent)i=a.getLinearBrushOtherExtent(e);else{var s=t._zr;i=[0,[s.getWidth(),s.getHeight()][1-e]]}var u=[o,i];e&&u.reverse(),be(t,n,u,r)},updateCommon:_e,contain:Re}}function Ve(e){return e=He(e),function(t){return m(t,e)}}function Ne(e,t){return e=He(e),function(n){var o=null!=t?t:n,r=o?e.width:e.height,i=o?e.x:e.y;return[i,i+(r||0)]}}function Ze(e,t,n){var o=He(e);return function(e,r){return o.contain(r[0],r[1])&&!Q(e,t,n)}}function He(e){return v.create(e)}var je=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=n.type,e}return e(n,t),n.type="dataZoom.select",n}(G),Xe=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=n.type,e}return e(n,t),n.type="dataZoom.select",n}(W);function Ye(e){e.registerComponentModel(je),e.registerComponentView(Xe),U(e)}var Ge=function(){},We={};function Ue(e,t){We[e]=t}function qe(e){return We[e]}var $e=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=o.type,e}return e(o,t),o.prototype.optionUpdated=function(){t.prototype.optionUpdated.apply(this,arguments);var e=this.ecModel;n(this.option.feature,(function(t,n){var o=qe(n);o&&(o.getDefaultOption&&(o.defaultOption=o.getDefaultOption(e)),r(t,o.defaultOption))}))},o.type="toolbox",o.layoutMode={type:"box",ignoreSize:!0},o.defaultOption={show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},o}(y),Fe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.render=function(e,t,r,i){var a=this.group;if(a.removeAll(),e.get("show")){var u=+e.get("itemSize"),l=e.get("feature")||{},c=this._features||(this._features={}),d=[];n(l,(function(e,t){d.push(t)})),new s(this._featureNames||[],d).add(f).update(f).remove(p(f,null)).execute(),this._featureNames=d,q(a,e,r),a.add($(a.getBoundingRect(),e)),a.eachChild((function(e){var t=e.__title,n=e.ensureState("emphasis"),o=n.textConfig||(n.textConfig={}),i=e.getTextContent(),s=i&&i.states.emphasis;if(s&&!A(s)&&t){var l=s.style||(s.style={}),c=k(t,M.makeFont(l)),d=e.x+a.x,p=!1;e.y+a.y+u+c.height>r.getHeight()&&(o.position="top",p=!0);var f=p?-5-c.height:u+8;d+c.width/2>r.getWidth()?(o.position=["100%",f],l.align="right"):d-c.width/2<0&&(o.position=[0,f],l.align="left")}}))}function f(s,p){var f,h=d[s],g=d[p],m=l[h],v=new x(m,e,e.ecModel);if(i&&null!=i.newTitle&&i.featureName===h&&(m.title=i.newTitle),h&&!g){if(function(e){return 0===e.indexOf("my")}(h))f={onclick:v.option.onclick,featureName:h};else{var y=qe(h);if(!y)return;f=new y}c[h]=f}else if(!(f=c[g]))return;f.uid=b("toolbox-feature"),f.model=v,f.ecModel=t,f.api=r;var A=f instanceof Ge;h||!g?!v.get("show")||A&&f.unusable?A&&f.remove&&f.remove(t,r):(!function(i,s,l){var c,d,p=i.getModel("iconStyle"),f=i.getModel(["emphasis","iconStyle"]),h=s instanceof Ge&&s.getIcons?s.getIcons():i.get("icon"),g=i.get("title")||{};"string"==typeof h?(c={})[l]=h:c=h;"string"==typeof g?(d={})[l]=g:d=g;var m=i.iconPaths={};n(c,(function(n,l){var c=w(n,{},{x:-u/2,y:-u/2,width:u,height:u});c.setStyle(p.getItemStyle()),c.ensureState("emphasis").style=f.getItemStyle();var h=new M({style:{text:d[l],align:f.get("textAlign"),borderRadius:f.get("textBorderRadius"),padding:f.get("textPadding"),fill:null},ignore:!0});c.setTextContent(h),T({el:c,componentModel:e,itemName:l,formatterParamsExtra:{title:d[l]}}),c.__title=d[l],c.on("mouseover",(function(){var t=f.getItemStyle(),n="vertical"===e.get("orient")?null==e.get("right")?"right":"left":null==e.get("bottom")?"bottom":"top";h.setStyle({fill:f.get("textFill")||t.fill||t.stroke||"#000",backgroundColor:f.get("textBackgroundColor")}),c.setTextConfig({position:f.get("textPosition")||n}),h.ignore=!e.get("showTitle"),_(this)})).on("mouseout",(function(){"emphasis"!==i.get(["iconStatus",l])&&C(this),h.hide()})),("emphasis"===i.get(["iconStatus",l])?_:C)(c),a.add(c),c.on("click",o(s.onclick,s,t,r,l)),m[l]=c}))}(v,f,h),v.setIconStatus=function(e,t){var n=this.option,o=this.iconPaths;n.iconStatus=n.iconStatus||{},n.iconStatus[e]=t,o[e]&&("emphasis"===t?_:C)(o[e])},f instanceof Ge&&f.render&&f.render(v,t,r,i)):A&&f.dispose&&f.dispose(t,r)}},r.prototype.updateView=function(e,t,o,r){n(this._features,(function(e){e instanceof Ge&&e.updateView&&e.updateView(e.model,t,o,r)}))},r.prototype.remove=function(e,t){n(this._features,(function(n){n instanceof Ge&&n.remove&&n.remove(e,t)})),this.group.removeAll()},r.prototype.dispose=function(e,t){n(this._features,(function(n){n instanceof Ge&&n.dispose&&n.dispose(e,t)}))},r.type="toolbox",r}(S);var Ke=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.onclick=function(e,t){var n=this.model,o=n.get("name")||e.get("title.0.text")||"echarts",r="svg"===t.getZr().painter.getType(),i=r?"svg":n.get("type",!0)||"png",a=t.getConnectedDataURL({type:i,backgroundColor:n.get("backgroundColor",!0)||e.get("backgroundColor")||"#fff",connectedBackgroundColor:n.get("connectedBackgroundColor"),excludeComponents:n.get("excludeComponents"),pixelRatio:n.get("pixelRatio")});if("function"!=typeof MouseEvent||!O.browser.newEdge&&(O.browser.ie||O.browser.edge))if(window.navigator.msSaveOrOpenBlob||r){var s=a.split(","),u=s[0].indexOf("base64")>-1,l=r?decodeURIComponent(s[1]):s[1];u&&(l=window.atob(l));var c=o+"."+i;if(window.navigator.msSaveOrOpenBlob){for(var d=l.length,p=new Uint8Array(d);d--;)p[d]=l.charCodeAt(d);var f=new Blob([p]);window.navigator.msSaveOrOpenBlob(f,c)}else{var h=document.createElement("iframe");document.body.appendChild(h);var g=h.contentWindow,m=g.document;m.open("image/svg+xml","replace"),m.write(l),m.close(),g.focus(),m.execCommand("SaveAs",!0,c),document.body.removeChild(h)}}else{var v=n.get("lang"),y='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(v&&v[0]||"")+'" /></body>',x=window.open();x.document.write(y),x.document.title=o}else{var b=document.createElement("a");b.download=o+"."+i,b.target="_blank",b.href=a;var _=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});b.dispatchEvent(_)}},n.getDefaultOption=function(e){return{show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:e.getLocale(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:e.getLocale(["toolbox","saveAsImage","lang"])}},n}(Ge);Ke.prototype.unusable=!O.canvasSupported;var Je=[["line","bar"],["stack"]],Qe=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return e(o,t),o.prototype.getIcons=function(){var e=this.model,t=e.get("icon"),o={};return n(e.get("type"),(function(e){t[e]&&(o[e]=t[e])})),o},o.getDefaultOption=function(e){return{show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:e.getLocale(["toolbox","magicType","title"]),option:{},seriesIndex:{}}},o.prototype.onclick=function(e,t,o){var i=this.model,a=i.get(["seriesIndex",o]);if(et[o]){var s,u={series:[]};n(Je,(function(e){I(e,o)>=0&&n(e,(function(e){i.setIconStatus(e,"normal")}))})),i.setIconStatus(o,"emphasis"),e.eachComponent({mainType:"series",query:null==a?null:{seriesIndex:a}},(function(e){var t=e.subType,n=e.id,r=et[o](t,n,e,i);r&&(c(r,e.option),u.series.push(r));var a=e.coordinateSystem;if(a&&"cartesian2d"===a.type&&("line"===o||"bar"===o)){var s=a.getAxesByScale("ordinal")[0];if(s){var l=s.dim+"Axis",d=e.getReferringComponents(l,L).models[0].componentIndex;u[l]=u[l]||[];for(var p=0;p<=d;p++)u[l][d]=u[l][d]||{};u[l][d].boundaryGap="bar"===o}}}));var l=o;"stack"===o&&(s=r({stack:i.option.title.tiled,tiled:i.option.title.stack},i.option.title),"emphasis"!==i.get(["iconStatus",o])&&(l="tiled")),t.dispatchAction({type:"changeMagicType",currentType:l,newOption:u,newTitle:s,featureName:"magicType"})}},o}(Ge),et={line:function(e,t,n,o){if("bar"===e)return r({id:t,type:"line",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},o.get(["option","line"])||{},!0)},bar:function(e,t,n,o){if("line"===e)return r({id:t,type:"bar",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},o.get(["option","bar"])||{},!0)},stack:function(e,t,n,o){var i="__ec_magicType_stack__"===n.get("stack");if("line"===e||"bar"===e)return o.setIconStatus("stack",i?"normal":"emphasis"),r({id:t,stack:i?"":"__ec_magicType_stack__"},o.get(["option","stack"])||{},!0)}};R({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},(function(e,t){t.mergeOption(e.newOption)}));var tt=new Array(60).join("-");function nt(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var ot=new RegExp("[\t]+","g");function rt(e,t){var o=e.split(new RegExp("\n*"+tt+"\n*","g")),r={series:[]};return n(o,(function(e,n){if(function(e){if(e.slice(0,e.indexOf("\n")).indexOf("\t")>=0)return!0}(e)){var o=function(e){for(var t=e.split(/\n+/g),n=nt(t.shift()).split(ot),o=[],r=a(n,(function(e){return{name:e,data:[]}})),i=0;i<t.length;i++){var s=nt(t[i]).split(ot);o.push(s.shift());for(var u=0;u<s.length;u++)r[u]&&(r[u].data[i]=s[u])}return{series:r,categories:o}}(e),i=t[n],s=i.axisDim+"Axis";i&&(r[s]=r[s]||[],r[s][i.axisIndex]={data:o.categories},r.series=r.series.concat(o.series))}else{o=function(e){for(var t=e.split(/\n+/g),n=nt(t.shift()),o=[],r=0;r<t.length;r++){var i=nt(t[r]);if(i){var a=i.split(ot),s="",u=void 0,l=!1;isNaN(a[0])?(l=!0,s=a[0],a=a.slice(1),o[r]={name:s,value:[]},u=o[r].value):u=o[r]=[];for(var c=0;c<a.length;c++)u.push(+a[c]);1===u.length&&(l?o[r].value=u[0]:o[r]=u[0])}}return{name:n,data:o}}(e);r.series.push(o)}})),r}var it=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return e(o,t),o.prototype.onclick=function(e,t){var o=t.getDom(),r=this.model;this._dom&&o.removeChild(this._dom);var i=document.createElement("div");i.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",i.style.backgroundColor=r.get("backgroundColor")||"#fff";var s=document.createElement("h4"),u=r.get("lang")||[];s.innerHTML=u[0]||r.get("title"),s.style.cssText="margin: 10px 20px;",s.style.color=r.get("textColor");var l=document.createElement("div"),c=document.createElement("textarea");l.style.cssText="display:block;width:100%;overflow:auto;";var d=r.get("optionToContent"),p=r.get("contentToOption"),f=function(e){var t,o,r,i=function(e){var t={},n=[],o=[];return e.eachRawSeries((function(e){var r=e.coordinateSystem;if(!r||"cartesian2d"!==r.type&&"polar"!==r.type)n.push(e);else{var i=r.getBaseAxis();if("category"===i.type){var a=i.dim+"_"+i.index;t[a]||(t[a]={categoryAxis:i,valueAxis:r.getOtherAxis(i),series:[]},o.push({axisDim:i.dim,axisIndex:i.index})),t[a].series.push(e)}else n.push(e)}})),{seriesGroupByCategoryAxis:t,other:n,meta:o}}(e);return{value:B([(o=i.seriesGroupByCategoryAxis,r=[],n(o,(function(e,t){var o=e.categoryAxis,i=e.valueAxis.dim,s=[" "].concat(a(e.series,(function(e){return e.name}))),u=[o.model.getCategories()];n(e.series,(function(e){var t=e.getRawData();u.push(e.getRawData().mapArray(t.mapDimension(i),(function(e){return e})))}));for(var l=[s.join("\t")],c=0;c<u[0].length;c++){for(var d=[],p=0;p<u.length;p++)d.push(u[p][c]);l.push(d.join("\t"))}r.push(l.join("\n"))})),r.join("\n\n"+tt+"\n\n")),(t=i.other,a(t,(function(e){var t=e.getRawData(),n=[e.name],o=[];return t.each(t.dimensions,(function(){for(var e=arguments.length,r=arguments[e-1],i=t.getName(r),a=0;a<e-1;a++)o[a]=arguments[a];n.push((i?i+"\t":"")+o.join("\t"))})),n.join("\n")})).join("\n\n"+tt+"\n\n"))],(function(e){return!!e.replace(/[\n\t\s]/g,"")})).join("\n\n"+tt+"\n\n"),meta:i.meta}}(e);if("function"==typeof d){var h=d(t.getOption());"string"==typeof h?l.innerHTML=h:D(h)&&l.appendChild(h)}else l.appendChild(c),c.readOnly=r.get("readOnly"),c.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",c.style.color=r.get("textColor"),c.style.borderColor=r.get("textareaBorderColor"),c.style.backgroundColor=r.get("textareaColor"),c.value=f.value;var g=f.meta,m=document.createElement("div");m.style.cssText="position:absolute;bottom:0;left:0;right:0;";var v="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",y=document.createElement("div"),x=document.createElement("div");v+=";background-color:"+r.get("buttonColor"),v+=";color:"+r.get("buttonTextColor");var b=this;function _(){o.removeChild(i),b._dom=null}E(y,"click",_),E(x,"click",(function(){if(null==p&&null!=d||null!=p&&null==d)_();else{var e;try{e="function"==typeof p?p(l,t.getOption()):rt(c.value,g)}catch(n){throw _(),new Error("Data view format error "+n)}e&&t.dispatchAction({type:"changeDataView",newOption:e}),_()}})),y.innerHTML=u[1],x.innerHTML=u[2],x.style.cssText=v,y.style.cssText=v,!r.get("readOnly")&&m.appendChild(x),m.appendChild(y),i.appendChild(s),i.appendChild(l),i.appendChild(m),l.style.height=o.clientHeight-80+"px",o.appendChild(i),this._dom=i},o.prototype.remove=function(e,t){this._dom&&t.getDom().removeChild(this._dom)},o.prototype.dispose=function(e,t){this.remove(e,t)},o.getDefaultOption=function(e){return{show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:e.getLocale(["toolbox","dataView","title"]),lang:e.getLocale(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"}},o}(Ge);function at(e,t){return a(e,(function(e,n){var o=t&&t[n];if(P(o)&&!V(o)){P(e)&&!V(e)||(e={value:e});var r=null!=o.name&&null==e.name;return e=c(e,o),r&&delete e.name,e}return e}))}R({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},(function(e,t){var o=[];n(e.newOption.series,(function(e){var n=t.getSeriesByName(e.name)[0];if(n){var r=n.get("data");o.push({name:e.name,data:at(e.data,r)})}else o.push(z({type:"scatter"},e))})),t.mergeOption(c({series:o},e.newOption))}));var st=n,ut=N();function lt(e){var t=ut(e);return t.snapshots||(t.snapshots=[{}]),t.snapshots}var ct=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.onclick=function(e,t){!function(e){ut(e).snapshots=null}(e),t.dispatchAction({type:"restore",from:this.uid})},n.getDefaultOption=function(e){return{show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:e.getLocale(["toolbox","restore","title"])}},n}(Ge);R({type:"restore",event:"restore",update:"prepareAndUpdate"},(function(e,t){t.resetOption("recreate")}));var dt=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],pt=function(){function e(e,t,o){var r=this;this._targetInfoList=[];var i=ht(t,e);n(gt,(function(e,t){(!o||!o.include||I(o.include,t)>=0)&&e(i,r._targetInfoList)}))}return e.prototype.setOutputRanges=function(e,t){return this.matchOutputRanges(e,t,(function(e,t,n){if((e.coordRanges||(e.coordRanges=[])).push(t),!e.coordRange){e.coordRange=t;var o=yt[e.brushType](0,n,t);e.__rangeOffset={offset:bt[e.brushType](o.values,e.range,[1,1]),xyMinMax:o.xyMinMax}}})),e},e.prototype.matchOutputRanges=function(e,t,o){n(e,(function(e){var r=this.findTargetInfo(e,t);r&&!0!==r&&n(r.coordSyses,(function(n){var r=yt[e.brushType](1,n,e.range,!0);o(e,r.values,n,t)}))}),this)},e.prototype.setInputRanges=function(e,t){n(e,(function(e){var n,o,r,i,a,s=this.findTargetInfo(e,t);if(e.range=e.range||[],s&&!0!==s){e.panelId=s.panelId;var u=yt[e.brushType](0,s.coordSys,e.coordRange),l=e.__rangeOffset;e.range=l?bt[e.brushType](u.values,l.offset,(n=u.xyMinMax,o=l.xyMinMax,r=Ct(n),i=Ct(o),a=[r[0]/i[0],r[1]/i[1]],isNaN(a[0])&&(a[0]=1),isNaN(a[1])&&(a[1]=1),a)):u.values}}),this)},e.prototype.makePanelOpts=function(e,t){return a(this._targetInfoList,(function(n){var o=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:t?t(n):null,clipPath:Ve(o),isTargetByCursor:Ze(o,e,n.coordSysModel),getLinearBrushOtherExtent:Ne(o)}}))},e.prototype.controlSeries=function(e,t,n){var o=this.findTargetInfo(e,n);return!0===o||o&&I(o.coordSyses,t.coordinateSystem)>=0},e.prototype.findTargetInfo=function(e,t){for(var n=this._targetInfoList,o=ht(t,e),r=0;r<n.length;r++){var i=n[r],a=e.panelId;if(a){if(i.panelId===a)return i}else for(var s=0;s<mt.length;s++)if(mt[s](o,i))return i}return!0},e}();function ft(e){return e[0]>e[1]&&e.reverse(),e}function ht(e,t){return Z(e,t,{includeMainTypes:dt})}var gt={grid:function(e,t){var o=e.xAxisModels,r=e.yAxisModels,i=e.gridModels,a=H(),s={},u={};(o||r||i)&&(n(o,(function(e){var t=e.axis.grid.model;a.set(t.id,t),s[t.id]=!0})),n(r,(function(e){var t=e.axis.grid.model;a.set(t.id,t),u[t.id]=!0})),n(i,(function(e){a.set(e.id,e),s[e.id]=!0,u[e.id]=!0})),a.each((function(e){var i=e.coordinateSystem,a=[];n(i.getCartesians(),(function(e,t){(I(o,e.getAxis("x").model)>=0||I(r,e.getAxis("y").model)>=0)&&a.push(e)})),t.push({panelId:"grid--"+e.id,gridModel:e,coordSysModel:e,coordSys:a[0],coordSyses:a,getPanelRect:vt.grid,xAxisDeclared:s[e.id],yAxisDeclared:u[e.id]})})))},geo:function(e,t){n(e.geoModels,(function(e){var n=e.coordinateSystem;t.push({panelId:"geo--"+e.id,geoModel:e,coordSysModel:e,coordSys:n,coordSyses:[n],getPanelRect:vt.geo})}))}},mt=[function(e,t){var n=e.xAxisModel,o=e.yAxisModel,r=e.gridModel;return!r&&n&&(r=n.axis.grid.model),!r&&o&&(r=o.axis.grid.model),r&&r===t.gridModel},function(e,t){var n=e.geoModel;return n&&n===t.geoModel}],vt={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var e=this.coordSys,t=e.getBoundingRect().clone();return t.applyTransform(g(e)),t}},yt={lineX:p(xt,0),lineY:p(xt,1),rect:function(e,t,n,o){var r=e?t.pointToData([n[0][0],n[1][0]],o):t.dataToPoint([n[0][0],n[1][0]],o),i=e?t.pointToData([n[0][1],n[1][1]],o):t.dataToPoint([n[0][1],n[1][1]],o),a=[ft([r[0],i[0]]),ft([r[1],i[1]])];return{values:a,xyMinMax:a}},polygon:function(e,t,n,o){var r=[[1/0,-1/0],[1/0,-1/0]];return{values:a(n,(function(n){var i=e?t.pointToData(n,o):t.dataToPoint(n,o);return r[0][0]=Math.min(r[0][0],i[0]),r[1][0]=Math.min(r[1][0],i[1]),r[0][1]=Math.max(r[0][1],i[0]),r[1][1]=Math.max(r[1][1],i[1]),i})),xyMinMax:r}}};function xt(e,t,n,o){var r=n.getAxis(["x","y"][e]),i=ft(a([0,1],(function(e){return t?r.coordToData(r.toLocalCoord(o[e]),!0):r.toGlobalCoord(r.dataToCoord(o[e]))}))),s=[];return s[e]=i,s[1-e]=[NaN,NaN],{values:i,xyMinMax:s}}var bt={lineX:p(_t,0),lineY:p(_t,1),rect:function(e,t,n){return[[e[0][0]-n[0]*t[0][0],e[0][1]-n[0]*t[0][1]],[e[1][0]-n[1]*t[1][0],e[1][1]-n[1]*t[1][1]]]},polygon:function(e,t,n){return a(e,(function(e,o){return[e[0]-n[0]*t[o][0],e[1]-n[1]*t[o][1]]}))}};function _t(e,t,n,o){return[t[0]-o[e]*n[0],t[1]-o[e]*n[1]]}function Ct(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var wt=n,Mt=X("toolbox-dataZoom_"),Tt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.render=function(e,t,n,r){this._brushController||(this._brushController=new se(n.getZr()),this._brushController.on("brush",o(this._onBrush,this)).mount()),function(e,t,n,o,r){var i=n._isZoomActive;o&&"takeGlobalCursor"===o.type&&(i="dataZoomSelect"===o.key&&o.dataZoomSelectActive);n._isZoomActive=i,e.setIconStatus("zoom",i?"emphasis":"normal");var a=new pt(kt(e),t,{include:["grid"]}).makePanelOpts(r,(function(e){return e.xAxisDeclared&&!e.yAxisDeclared?"lineX":!e.xAxisDeclared&&e.yAxisDeclared?"lineY":"rect"}));n._brushController.setPanels(a).enableBrush(!(!i||!a.length)&&{brushType:"auto",brushStyle:e.getModel("brushStyle").getItemStyle()})}(e,t,this,r,n),function(e,t){e.setIconStatus("back",function(e){return lt(e).length}(t)>1?"emphasis":"normal")}(e,t)},n.prototype.onclick=function(e,t,n){At[n].call(this)},n.prototype.remove=function(e,t){this._brushController&&this._brushController.unmount()},n.prototype.dispose=function(e,t){this._brushController&&this._brushController.dispose()},n.prototype._onBrush=function(e){var t=e.areas;if(e.isEnd&&t.length){var n={},o=this.ecModel;this._brushController.updateCovers([]),new pt(kt(this.model),o,{include:["grid"]}).matchOutputRanges(t,o,(function(e,t,n){if("cartesian2d"===n.type){var o=e.brushType;"rect"===o?(r("x",n,t[0]),r("y",n,t[1])):r({lineX:"x",lineY:"y"}[o],n,t)}})),function(e,t){var n=lt(e);st(t,(function(t,o){for(var r=n.length-1;r>=0&&!n[r][o];r--);if(r<0){var i=e.queryComponents({mainType:"dataZoom",subType:"select",id:o})[0];if(i){var a=i.getPercentRange();n[0][o]={dataZoomId:o,start:a[0],end:a[1]}}}})),n.push(t)}(o,n),this._dispatchZoomAction(n)}function r(e,t,r){var i=t.getAxis(e),a=i.model,s=function(e,t,n){var o;return n.eachComponent({mainType:"dataZoom",subType:"select"},(function(n){n.getAxisModel(e,t.componentIndex)&&(o=n)})),o}(e,a,o),u=s.findRepresentativeAxisProxy(a).getMinMaxSpan();null==u.minValueSpan&&null==u.maxValueSpan||(r=J(0,r.slice(),i.scale.getExtent(),0,u.minValueSpan,u.maxValueSpan)),s&&(n[s.id]={dataZoomId:s.id,startValue:r[0],endValue:r[1]})}},n.prototype._dispatchZoomAction=function(e){var t=[];wt(e,(function(e,n){t.push(i(e))})),t.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:t})},n.getDefaultOption=function(e){return{show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:e.getLocale(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}}},n}(Ge),At={zoom:function(){var e=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:e})},back:function(){this._dispatchZoomAction(function(e){var t=lt(e),n=t[t.length-1];t.length>1&&t.pop();var o={};return st(n,(function(e,n){for(var r=t.length-1;r>=0;r--)if(e=t[r][n]){o[n]=e;break}})),o}(this.ecModel))}};function kt(e){var t={xAxisIndex:e.get("xAxisIndex",!0),yAxisIndex:e.get("yAxisIndex",!0),xAxisId:e.get("xAxisId",!0),yAxisId:e.get("yAxisId",!0)};return null==t.xAxisIndex&&null==t.xAxisId&&(t.xAxisIndex="all"),null==t.yAxisIndex&&null==t.yAxisId&&(t.yAxisIndex="all"),t}function St(e){e.registerComponentModel($e),e.registerComponentView(Fe),Ue("saveAsImage",Ke),Ue("magicType",Qe),Ue("dataView",it),Ue("dataZoom",Tt),Ue("restore",ct),Y(Ye)}j("dataZoom",(function(e){var t=e.getComponent("toolbox",0),n=["feature","dataZoom"];if(t&&null!=t.get(n)){var o=t.getModel(n),r=[],i=kt(o),a=Z(e,i);return wt(a.xAxisModels,(function(e){return s(e,"xAxis","xAxisIndex")})),wt(a.yAxisModels,(function(e){return s(e,"yAxis","yAxisIndex")})),r}function s(e,t,n){var i=e.componentIndex,a={type:"select",$fromToolbox:!0,filterMode:o.get("filterMode",!0)||"filter",id:Mt+t+i};a[n]=i,r.push(a)}}));export{se as B,Ge as T,Ze as a,Ne as b,pt as c,St as i,Ve as m,Ue as r};
