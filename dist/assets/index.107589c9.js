var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{s as r,_ as s}from"./index.f97a2892.js";import{d as n,D as d,x as i,y as u,r as m,o as c,c as p,k as g,l as b,m as h,p as f,n as y,C as v,w,H as _,t as D,I as V,j as C}from"./vendor.910582b6.js";import{a as F,u as T,_ as $}from"./table.3dcc7f0f.js";var U=n({components:{Layer:s},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup:(e,a)=>({ruleForm:d({name:""}),rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],sort:[{required:!0,message:"请输入数字",trigger:"blur"}],select:[{required:!0,message:"请选择",trigger:"blur"}],radio:[{required:!0,message:"请选择",trigger:"blur"}]},options:[{value:1,label:"运动"},{value:2,label:"健身"},{value:3,label:"跑酷"},{value:4,label:"街舞"}]}),methods:{submit(){this.$refs.form.validate((e=>{if(!e)return!1;{let e=this.ruleForm;this.layer.row?this.updateForm(e):this.addForm(e)}}))},addForm(e){F(e).then((e=>{this.$message({type:"success",message:"新增成功"}),this.layer.show=!1,this.$emit("getTableData",!0)}))},updateForm(e){T(e).then((e=>{this.$message({type:"success",message:"编辑成功"}),this.$emit("getTableData",!1)}))}}});const k=f();i("data-v-a05d7fba");const x=y("最新开播"),j=y("最早开播"),S=y("最多观看");u();const q=k(((e,a,l,t,o,r)=>{const s=m("el-input"),n=m("el-form-item"),d=m("el-option"),i=m("el-select"),u=m("el-radio"),f=m("el-radio-group"),y=m("el-form"),v=m("Layer",!0);return c(),p(v,{layer:e.layer,onConfirm:e.submit},{default:k((()=>[g(y,{model:e.ruleForm,rules:e.rules,ref:"form","label-width":"120px",style:{"margin-right":"30px"}},{default:k((()=>[g(n,{label:"名称：",prop:"name"},{default:k((()=>[g(s,{modelValue:e.ruleForm.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.ruleForm.name=a),placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),g(n,{label:"数字：",prop:"sort"},{default:k((()=>[g(s,{modelValue:e.ruleForm.sort,"onUpdate:modelValue":a[2]||(a[2]=a=>e.ruleForm.sort=a),oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"只能输入正整数"},null,8,["modelValue"])])),_:1}),g(n,{label:"选择器：",prop:"select"},{default:k((()=>[g(i,{modelValue:e.ruleForm.select,"onUpdate:modelValue":a[3]||(a[3]=a=>e.ruleForm.select=a),placeholder:"请选择",clearable:""},{default:k((()=>[(c(!0),p(b,null,h(e.options,(e=>(c(),p(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(n,{label:"单选框：",prop:"radio"},{default:k((()=>[g(f,{modelValue:e.ruleForm.radio,"onUpdate:modelValue":a[4]||(a[4]=a=>e.ruleForm.radio=a)},{default:k((()=>[g(u,{label:0},{default:k((()=>[x])),_:1}),g(u,{label:1},{default:k((()=>[j])),_:1}),g(u,{label:2},{default:k((()=>[S])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["layer","onConfirm"])}));U.render=q,U.__scopeId="data-v-a05d7fba";var L=n({components:{Table:$,Layer:U},setup(){const e=d({input:""}),s=d({show:!1,title:"新增",showButton:!0}),n=d({index:1,size:20,total:0}),i=v(!0),u=v([]),m=v([]),c=s=>{i.value=!0,s&&(n.index=1);let d=((e,r)=>{for(var s in r||(r={}))l.call(r,s)&&o(e,s,r[s]);if(a)for(var s of a(r))t.call(r,s)&&o(e,s,r[s]);return e})({page:n.index,pageSize:n.size},e);var m;(m=d,r({url:"/system/user/list",method:"post",baseURL:"/mock",data:m})).then((e=>{let a=e.data.list;a.forEach((e=>{e.loading=!1})),u.value=a,n.total=Number(e.data.pager.total)})).catch((e=>{u.value=[],n.index=1,n.total=0})).finally((()=>{i.value=!1}))};return c(!0),{query:e,tableData:u,chooseData:m,loading:i,page:n,layer:s,handleSelectionChange:e=>{m.value=e},getTableData:c,handleDel:e=>{(function(e){return r({url:"/system/user/del",method:"post",baseURL:"/mock",data:e})})({ids:e.map((e=>e.id)).join(",")}).then((e=>{w({type:"success",message:"删除成功"}),c(1===u.value.length)}))},handleAdd:()=>{s.title="新增数据",s.show=!0,delete s.row},handleEdit:e=>{s.title="编辑数据",s.row=e,s.show=!0},handleUpdateStatus:e=>{if(!e.id)return;e.loading=!0;let a={id:e.id,status:e.status};var l;(l=a,r({url:"/system/user/updateStatus",method:"post",baseURL:"/mock",data:l})).then((e=>{w({type:"success",message:"状态变更成功"})})).catch((e=>{w({type:"error",message:"状态变更失败"})})).finally((()=>{e.loading=!1}))}}}});const O=f();i("data-v-2b17112e");const I={class:"layout-container"},A={class:"layout-container-form flex space-between"},E={class:"layout-container-form-handle"},G={class:"layout-container-form-search"},N={class:"layout-container-table"},z={class:"statusName"},B={class:"statusName"};u();const P=O(((e,a,l,t,o,r)=>{const s=m("el-button"),n=m("el-popconfirm"),d=m("el-input"),i=m("el-table-column"),u=m("el-switch"),b=m("Table"),h=m("Layer"),f=_("loading");return c(),p("div",I,[g("div",A,[g("div",E,[g(s,{type:"primary",icon:"el-icon-circle-plus-outline",onClick:e.handleAdd},{default:O((()=>[y(D(e.$t("message.common.add")),1)])),_:1},8,["onClick"]),g(n,{title:e.$t("message.common.delTip"),onConfirm:a[1]||(a[1]=a=>e.handleDel(e.chooseData))},{reference:O((()=>[g(s,{type:"danger",icon:"el-icon-delete",disabled:0===e.chooseData.length},{default:O((()=>[y(D(e.$t("message.common.delBat")),1)])),_:1},8,["disabled"])])),_:1},8,["title"])]),g("div",G,[g(d,{modelValue:e.query.input,"onUpdate:modelValue":a[2]||(a[2]=a=>e.query.input=a),placeholder:e.$t("message.common.searchTip")},null,8,["modelValue","placeholder"]),g(s,{type:"primary",icon:"el-icon-search",class:"search-btn",onClick:a[3]||(a[3]=a=>e.getTableData(!0))},{default:O((()=>[y(D(e.$t("message.common.search")),1)])),_:1})])]),g("div",N,[V(g(b,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=a=>e.page=a),showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:O((()=>[g(i,{prop:"id",label:"Id",align:"center",width:"80"}),g(i,{prop:"name",label:"用户名",align:"center"}),g(i,{prop:"nickName",label:"昵称",align:"center"}),g(i,{prop:"role",label:"角色",align:"center"}),g(i,{prop:"isAdmin",label:"超级管理员",align:"center"},{default:O((e=>[g("span",z,D(1===e.row.isAdmin?"是":"否"),1)])),_:1}),g(i,{prop:"status",label:"状态",align:"center"},{default:O((a=>[g("span",B,D(1===a.row.status?"启用":"禁用"),1),g(u,{modelValue:a.row.status,"onUpdate:modelValue":e=>a.row.status=e,"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0,loading:a.row.loading,onChange:l=>e.handleUpdateStatus(a.row)},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])])),_:1}),g(i,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:O((a=>[g(s,{onClick:l=>e.handleEdit(a.row)},{default:O((()=>[y(D(e.$t("message.common.update")),1)])),_:2},1032,["onClick"]),g(n,{title:e.$t("message.common.delTip"),onConfirm:l=>e.handleDel([a.row])},{reference:O((()=>[g(s,{type:"danger"},{default:O((()=>[y(D(e.$t("message.common.del")),1)])),_:1})])),_:2},1032,["title","onConfirm"])])),_:1},8,["label"])])),_:1},8,["page","data","onGetTableData","onSelectionChange"]),[[f,e.loading]]),e.layer.show?(c(),p(h,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):C("",!0)])])}));L.render=P,L.__scopeId="data-v-2b17112e";export default L;
