import{e as t,cS as e,A as a,_ as i,X as n,aP as r,m as o,ax as s,G as l,k as c,o as d,q as u,Z as p,a as h,b4 as m,aa as g,ab as f,aA as y,C as v,bd as x,b as I,a2 as S,cT as b,N as A,S as M,aY as w,M as T,aH as _,a$ as L,b7 as N,bq as P,bU as D,bV as k,a_ as C,h as E,cU as V,b1 as G,cV as z,az as F,cd as j,u as B}from"./install.f743767a.js";import{L as O,d as R}from"./LegendVisualProvider.84b89ceb.js";import{c as q}from"./createListSimply.02618497.js";import{a as H,e as U,A as X}from"./install.d08ad8ea.js";function Y(a){a.eachSeriesByType("radar",(function(a){var i=a.getData(),n=[],r=a.coordinateSystem;if(r){var o=r.getIndicatorAxes();t(o,(function(t,e){i.each(i.mapDimension(o[e].dim),(function(t,a){n[a]=n[a]||[];var i=r.dataToPoint(t,e);n[a][e]=W(i)?i:Z(r)}))})),i.each((function(t){var a=e(n[t],(function(t){return W(t)}))||Z(r);n[t].push(a.slice()),i.setItemLayout(t,n[t])}))}}))}function W(t){return!isNaN(t[0])&&!isNaN(t[1])}function Z(t){return[t.cx,t.cy]}function $(e){var i=e.polar;if(i){a(i)||(i=[i]);var n=[];t(i,(function(t,i){t.indicator?(t.type&&!t.shape&&(t.shape=t.type),e.radar=e.radar||[],a(e.radar)||(e.radar=[e.radar]),e.radar.push(t)):n.push(t)})),e.polar=n}t(e.series,(function(t){t&&"radar"===t.type&&t.polarIndex&&(t.radarIndex=t.polarIndex)}))}var J=function(e){function v(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=v.type,t}return i(v,e),v.prototype.render=function(e,i,v){var S=e.coordinateSystem,b=this.group,A=e.getData(),M=this._data;function w(t,e){var i=t.getItemVisual(e,"symbol")||"circle";if("none"!==i){var n=function(t){return a(t)||(t=[+t,+t]),t}(t.getItemVisual(e,"symbolSize")),r=I(i,-1,-1,2,2),o=t.getItemVisual(e,"symbolRotate")||0;return r.attr({style:{strokeNoScale:!0},z2:100,scaleX:n[0]/2,scaleY:n[1]/2,rotation:o*Math.PI/180||0}),r}}function T(t,a,i,n,r,o){i.removeAll();for(var s=0;s<a.length-1;s++){var l=w(n,r);l&&(l.__dimIdx=s,t[s]?(l.setPosition(t[s]),x[o?"initProps":"updateProps"](l,{x:a[s][0],y:a[s][1]},e,r)):l.setPosition(a[s]),i.add(l))}}function _(t){return o(t,(function(t){return[S.cx,S.cy]}))}A.diff(M).add((function(t){var a=A.getItemLayout(t);if(a){var i=new n,o=new r,c={shape:{points:a}};i.shape.points=_(a),o.shape.points=_(a),s(i,c,e,t),s(o,c,e,t);var d=new l,u=new l;d.add(o),d.add(i),d.add(u),T(o.shape.points,a,u,A,t,!0),A.setItemGraphicEl(t,d)}})).update((function(t,a){var i=M.getItemGraphicEl(a),n=i.childAt(0),r=i.childAt(1),o=i.childAt(2),s={shape:{points:A.getItemLayout(t)}};s.shape.points&&(T(n.shape.points,s.shape.points,o,A,t,!1),c(n,s,e),c(r,s,e),A.setItemGraphicEl(t,i))})).remove((function(t){b.remove(M.getItemGraphicEl(t))})).execute(),A.eachItemGraphicEl((function(e,a){var i=A.getItemModel(a),n=e.childAt(0),r=e.childAt(1),o=e.childAt(2),s=A.getItemVisual(a,"style"),l=s.fill;b.add(e),n.useStyle(d(i.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:l})),u(n,i,"lineStyle"),u(r,i,"areaStyle");var c=i.getModel("areaStyle"),v=c.isEmpty()&&c.parentModel.isEmpty();r.ignore=v,t(["emphasis","select","blur"],(function(t){var e=i.getModel([t,"areaStyle"]),a=e.isEmpty()&&e.parentModel.isEmpty();r.ensureState(t).ignore=a&&v})),r.useStyle(d(c.getAreaStyle(),{fill:l,opacity:.7,decal:s.decal}));var x=i.getModel("emphasis"),I=x.getModel("itemStyle").getItemStyle();o.eachChild((function(t){if(t instanceof p){var e=t.style;t.useStyle(h({image:e.image,x:e.x,y:e.y,width:e.width,height:e.height},s))}else t.useStyle(s),t.setColor(l);t.ensureState("emphasis").style=m(I);var n=A.get(A.dimensions[t.__dimIdx],a);(null==n||isNaN(n))&&(n=""),g(t,f(i),{labelFetcher:A.hostModel,labelDataIndex:a,labelDimIndex:t.__dimIdx,defaultText:n,inheritColor:l,defaultOpacity:s.opacity})})),y(e,x.get("focus"),x.get("blurScope"))})),this._data=A},v.prototype.remove=function(){this.group.removeAll(),this._data=null},v.type="radar",v}(v),K=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a.useColorPaletteOnData=!0,a.hasSymbolVisual=!0,a}return i(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new O(S(this.getData,this),S(this.getRawData,this))},e.prototype.getInitialData=function(t,e){return q(this,{generateCoord:"indicator_",generateCoordCount:1/0})},e.prototype.formatTooltip=function(t,e,a){var i=this.getData(),n=this.coordinateSystem.getIndicatorAxes(),r=this.getData().getName(t),s=""===r?this.name:r,l=b(this,t);return A("section",{header:s,sortBlocks:!0,blocks:o(n,(function(e){var a=i.get(i.mapDimension(e.dim),t);return A("nameValue",{markerType:"subItem",markerColor:l,name:e.name,value:a,sortParam:a})}))})},e.prototype.getTooltipPosition=function(t){if(null!=t)for(var e=this.getData(),a=this.coordinateSystem,i=e.getValues(o(a.dimensions,(function(t){return e.mapDimension(t)})),t),n=0,r=i.length;n<r;n++)if(!isNaN(i[n])){var s=a.getIndicatorAxes();return a.coordToPoint(s[n].dataToCoord(i[n]),n)}},e.type="series.radar",e.dependencies=["radar"],e.defaultOption={zlevel:0,z:2,coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid"},label:{position:"top"},symbolSize:8},e}(M),Q=U.value;function tt(t,e){return d({show:e},t)}var et=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return i(e,t),e.prototype.optionUpdated=function(){var t=this.get("boundaryGap"),e=this.get("splitNumber"),a=this.get("scale"),i=this.get("axisLine"),n=this.get("axisTick"),r=this.get("axisLabel"),s=this.get("axisName"),l=this.get(["axisName","show"]),c=this.get(["axisName","formatter"]),u=this.get("axisNameGap"),p=this.get("triggerEvent"),h=o(this.get("indicator")||[],(function(o){null!=o.max&&o.max>0&&!o.min?o.min=0:null!=o.min&&o.min<0&&!o.max&&(o.max=0);var h=s;null!=o.color&&(h=d({color:o.color},s));var g=w(m(o),{boundaryGap:t,splitNumber:e,scale:a,axisLine:i,axisTick:n,axisLabel:r,name:o.text,nameLocation:"end",nameGap:u,nameTextStyle:h,triggerEvent:p},!1);if(l||(g.name=""),"string"==typeof c){var f=g.name;g.name=c.replace("{value}",null!=f?f:"")}else"function"==typeof c&&(g.name=c(g.name,g));var y=new T(g,null,this.ecModel);return _(y,H.prototype),y.mainType="radar",y.componentIndex=this.componentIndex,y}),this);this._indicatorModels=h},e.prototype.getIndicatorModels=function(){return this._indicatorModels},e.type="radar",e.defaultOption={zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:w({lineStyle:{color:"#bbb"}},Q.axisLine),axisLabel:tt(Q.axisLabel,!1),axisTick:tt(Q.axisTick,!1),splitLine:tt(Q.splitLine,!0),splitArea:tt(Q.splitArea,!0),indicator:[]},e}(L),at=["axisLine","axisTickLabel","axisName"],it=function(e){function s(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=s.type,t}return i(s,e),s.prototype.render=function(t,e,a){this.group.removeAll(),this._buildAxes(t),this._buildSplitLineAndArea(t)},s.prototype._buildAxes=function(e){var a=e.coordinateSystem,i=a.getIndicatorAxes(),n=o(i,(function(t){return new N(t.model,{position:[a.cx,a.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})}));t(n,(function(e){t(at,e.add,e),this.group.add(e.getGroup())}),this)},s.prototype._buildSplitLineAndArea=function(e){var i=e.coordinateSystem,s=i.getIndicatorAxes();if(s.length){var l=e.get("shape"),c=e.getModel("splitLine"),u=e.getModel("splitArea"),p=c.getModel("lineStyle"),h=u.getModel("areaStyle"),m=c.get("show"),g=u.get("show"),f=p.get("color"),y=h.get("color"),v=a(f)?f:[f],x=a(y)?y:[y],I=[],S=[];if("circle"===l)for(var b=s[0].getTicksCoords(),A=i.cx,M=i.cy,w=0;w<b.length;w++){if(m)I[G(I,v,w)].push(new P({shape:{cx:A,cy:M,r:b[w].coord}}));if(g&&w<b.length-1)S[G(S,x,w)].push(new D({shape:{cx:A,cy:M,r0:b[w].coord,r:b[w+1].coord}}))}else{var T,_=o(s,(function(t,e){var a=t.getTicksCoords();return T=null==T?a.length-1:Math.min(a.length-1,T),o(a,(function(t){return i.coordToPoint(t.coord,e)}))})),L=[];for(w=0;w<=T;w++){for(var N=[],C=0;C<s.length;C++)N.push(_[C][w]);if(N[0]&&N.push(N[0].slice()),m)I[G(I,v,w)].push(new r({shape:{points:N}}));if(g&&L)S[G(S,x,w-1)].push(new n({shape:{points:N.concat(L)}}));L=N.slice().reverse()}}var E=p.getLineStyle(),V=h.getAreaStyle();t(S,(function(t,e){this.group.add(k(t,{style:d({stroke:"none",fill:x[e%x.length]},V),silent:!0}))}),this),t(I,(function(t,e){this.group.add(k(t,{style:d({fill:"none",stroke:v[e%v.length]},E),silent:!0}))}),this)}function G(t,e,a){var i=a%e.length;return t[i]=t[i]||[],i}},s.type="radar",s}(C),nt=function(t){function e(e,a,i){var n=t.call(this,e,a,i)||this;return n.type="value",n.angle=0,n.name="",n}return i(e,t),e}(X),rt=function(){function e(t,e,a){this.dimensions=[],this._model=t,this._indicatorAxes=o(t.getIndicatorModels(),(function(t,e){var a="indicator_"+e,i=new nt(a,new j);return i.name=t.get("name"),i.model=t,t.axis=i,this.dimensions.push(a),i}),this),this.resize(t,a)}return e.prototype.getIndicatorAxes=function(){return this._indicatorAxes},e.prototype.dataToPoint=function(t,e){var a=this._indicatorAxes[e];return this.coordToPoint(a.dataToCoord(t),e)},e.prototype.coordToPoint=function(t,e){var a=this._indicatorAxes[e].angle;return[this.cx+t*Math.cos(a),this.cy-t*Math.sin(a)]},e.prototype.pointToData=function(t){var e=t[0]-this.cx,a=t[1]-this.cy,i=Math.sqrt(e*e+a*a);e/=i,a/=i;for(var n,r=Math.atan2(-a,e),o=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var c=this._indicatorAxes[l],d=Math.abs(r-c.angle);d<o&&(n=c,s=l,o=d)}return[s,+(n&&n.coordToData(i))]},e.prototype.resize=function(e,a){var i=e.get("center"),n=a.getWidth(),r=a.getHeight(),o=Math.min(n,r)/2;this.cx=E(i[0],n),this.cy=E(i[1],r),this.startAngle=e.get("startAngle")*Math.PI/180;var s=e.get("radius");"string"!=typeof s&&"number"!=typeof s||(s=[0,s]),this.r0=E(s[0],o),this.r=E(s[1],o),t(this._indicatorAxes,(function(t,e){t.setExtent(this.r0,this.r);var a=this.startAngle+e*Math.PI*2/this._indicatorAxes.length;a=Math.atan2(Math.sin(a),Math.cos(a)),t.angle=a}),this)},e.prototype.update=function(e,a){var i=this._indicatorAxes,n=this._model;t(i,(function(t){t.scale.setExtent(1/0,-1/0)})),e.eachSeriesByType("radar",(function(a,r){if("radar"===a.get("coordinateSystem")&&e.getComponent("radar",a.get("radarIndex"))===n){var o=a.getData();t(i,(function(t){t.scale.unionExtentFromData(o,o.mapDimension(t.dim))}))}}),this);var r=n.get("splitNumber");function o(t){var e=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),a=t/e;return 2===a?a=5:a*=2,a*e}t(i,(function(t,e){var a=V(t.scale,t.model).extent;G(t.scale,t.model);var i=t.model,n=t.scale,s=z(n,i.get("min",!0)),l=z(n,i.get("max",!0)),c=n.getInterval();if(null!=s&&null!=l)n.setExtent(+s,+l),n.setInterval((l-s)/r);else if(null!=s){var d=void 0;do{d=s+c*r,n.setExtent(+s,d),n.setInterval(c),c=o(c)}while(d<a[1]&&isFinite(d)&&isFinite(a[1]))}else if(null!=l){var u=void 0;do{u=l-c*r,n.setExtent(u,+l),n.setInterval(c),c=o(c)}while(u>a[0]&&isFinite(u)&&isFinite(a[0]))}else{n.getTicks().length-1>r&&(c=o(c));d=Math.ceil(a[1]/c)*c,u=F(d-c*r);n.setExtent(u,d),n.setInterval(c)}}))},e.prototype.convertToPixel=function(t,e,a){return console.warn("Not implemented."),null},e.prototype.convertFromPixel=function(t,e,a){return console.warn("Not implemented."),null},e.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},e.create=function(t,a){var i=[];return t.eachComponent("radar",(function(n){var r=new e(n,t,a);i.push(r),n.coordinateSystem=r})),t.eachSeriesByType("radar",(function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=i[t.get("radarIndex")||0])})),i},e.dimensions=[],e}();function ot(t){t.registerCoordinateSystem("radar",rt),t.registerComponentModel(et),t.registerComponentView(it),t.registerVisual({seriesType:"radar",reset:function(t){var e=t.getData();e.each((function(t){e.setItemVisual(t,"legendIcon","roundRect")})),e.setVisual("legendIcon","roundRect")}})}function st(t){B(ot),t.registerChartView(J),t.registerSeriesModel(K),t.registerLayout(Y),t.registerProcessor(R("radar")),t.registerPreprocessor($)}export{st as i};
